complete:

implement propagation after manual collapse.
last collapse is not context aware.
