implement propagation after manual collapse.

complete:

last collapse is not context aware.
