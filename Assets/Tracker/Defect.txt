complete:

implement retry on uncollapsible modules.
implement propagation after manual collapse.
last collapse is not context aware.
